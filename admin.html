<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asset Manager - Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <!-- Supabase & QR Lib -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>

<body>
    <div id="app" class="content-with-nav">
        <!-- HEADER -->
        <header
            style="padding: 1rem; background: var(--card-bg); position: sticky; top: 0; z-index: 50; box-shadow: var(--shadow); display: flex; justify-content: space-between; align-items: center;">
            <h3>Admin Panel</h3>
            <span id="user-email" style="font-size: 0.8rem; color: var(--text-muted);"></span>
        </header>

        <!-- VIEW: EMPLOYEES -->
        <div id="view-employees" class="view-section container">
            <div class="flex justify-between items-center mb-4">
                <h2>Employees</h2>
                <button onclick="router.navigate('add')" class="btn btn-outline" style="padding: 0.5rem;">+ New</button>
            </div>
            <div id="employee-list" class="flex-col gap-4">
                <!-- Employee items will be injected here -->
                <div class="text-center" style="margin-top: 2rem; color: var(--text-muted);">Loading employees...</div>
            </div>
        </div>

        <!-- VIEW: ASSETS -->
        <div id="view-assets" class="view-section container hidden">
            <div class="flex justify-between items-center mb-4">
                <h2>Assets</h2>
                <button onclick="router.navigate('add')" class="btn btn-outline" style="padding: 0.5rem;">+ New</button>
            </div>
            <div id="asset-list" class="flex-col gap-4">
                <!-- Asset items will be injected here -->
                <div class="text-center" style="margin-top: 2rem; color: var(--text-muted);">Loading assets...</div>
            </div>
        </div>

        <!-- VIEW: ADD (Shared Form) -->
        <div id="view-add" class="view-section container hidden">
            <h2 class="mb-4 text-center">Add New Item</h2>

            <div class="card">
                <div class="flex justify-center gap-4 mb-4"
                    style="border-bottom: 1px solid var(--border-color); padding-bottom: 1rem;">
                    <button id="tab-add-employee" class="btn btn-outline w-full"
                        onclick="ui.toggleAddTab('employee')">Employee</button>
                    <button id="tab-add-asset" class="btn btn-outline w-full"
                        style="border-color: transparent; color: var(--text-muted);"
                        onclick="ui.toggleAddTab('asset')">Asset</button>
                </div>

                <!-- FORM: EMPLOYEE -->
                <form id="form-employee">
                    <div class="input-group">
                        <label class="input-label">Company</label>
                        <select name="company" class="input-field" required>
                            <option value="">Select Company</option>
                            <option value="Osan Studio">Osan Studio</option>
                            <option value="Osbic">Osbic</option>
                            <option value="ASAS">ASAS</option>
                            <option value="Maisarah">Maisarah</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Full Name</label>
                        <input type="text" name="name" class="input-field" required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Email</label>
                        <input type="email" name="email" class="input-field" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">Create
                        Employee</button>
                </form>

                <!-- FORM: ASSET -->
                <form id="form-asset" class="hidden">
                    <div class="input-group">
                        <label class="input-label">Type</label>
                        <select name="type" class="input-field" required>
                            <option value="Laptop">Laptop</option>
                            <option value="Desktop">Desktop</option>
                            <option value="Monitor">Monitor</option>
                            <option value="Keyboard">Keyboard</option>
                            <option value="Mouse">Mouse</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Brand</label>
                        <input type="text" name="brand" class="input-field" required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Serial Number</label>
                        <input type="text" name="serial_number" class="input-field" required>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Assign To (Optional)</label>
                        <select name="employee_id" id="asset-employee-select" class="input-field">
                            <option value="">-- Unassigned --</option>
                            <!-- Populated dynamically -->
                        </select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Status</label>
                        <select name="status" class="input-field" required>
                            <option value="Working">Working</option>
                            <option value="Repair">Repair</option>
                            <option value="Replaced">Replaced</option>
                        </select>
                    </div>
                    <button type="submit" class="btn w-full">Add Asset</button>
                </form>
            </div>
        </div>

        <!-- VIEW: SETTINGS -->
        <div id="view-settings" class="view-section container hidden">
            <h2 class="mb-4">Settings</h2>
            <div class="card">
                <div class="items-center flex gap-4 mb-4">
                    <div
                        style="width: 50px; height: 50px; background: var(--bg-color); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        ðŸ‘¤
                    </div>
                    <div>
                        <h4 id="settings-email">Loading...</h4>
                        <p style="font-size: 0.8rem; color: var(--text-muted);">Administrator</p>
                    </div>
                </div>
                <button onclick="window.auth.logout()" class="btn btn-danger w-full">Sign Out</button>
            </div>

            <div class="card">
                <h4>About</h4>
                <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 0.5rem;">
                    Asset Management System v1.0<br>
                    Running on Supabase
                </p>
            </div>
        </div>
    </div>

    <!-- MODAL FOR EDITING -->
    <div id="edit-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Edit Item</h3>
                <button class="close-btn" onclick="ui.closeModal()">&times;</button>
            </div>
            <form id="edit-form">
                <!-- Fields injected dynamically -->
                <div id="modal-fields"></div>
                <div class="mt-4 flex gap-2">
                    <button type="button" class="btn btn-outline w-full" onclick="ui.closeModal()">Download</button>
                    <button type="submit" class="btn w-full">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- BOTTOM NAV -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="router.navigate('employees')" id="nav-employees">
            <svg viewBox="0 0 24 24">
                <path
                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
            </svg>
            <span>Employees</span>
        </div>
        <div class="nav-item" onclick="router.navigate('assets')" id="nav-assets">
            <svg viewBox="0 0 24 24">
                <path
                    d="M4 6h18V4H4c-1.1 0-2 .9-2 2v11H0v3h14v-3H4V6zm19 2h-6c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h6c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zm-1 9h-4v-7h4v7z" />
            </svg>
            <span>Assets</span>
        </div>
        <div class="nav-item" onclick="router.navigate('add')" id="nav-add">
            <svg viewBox="0 0 24 24">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
            </svg>
            <span>Add</span>
        </div>
        <div class="nav-item" onclick="router.navigate('settings')" id="nav-settings">
            <svg viewBox="0 0 24 24">
                <path
                    d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.57 1.62-.94l2.39.96c.22.09.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" />
            </svg>
            <span>Settings</span>
        </div>
    </nav>

    <!-- Scripts -->
    <script src="js/supabase-client.js?v=11"></script>
    <script src="js/auth.js?v=11"></script>
    <script src="js/admin.js?v=11"></script>
</body>

</html>